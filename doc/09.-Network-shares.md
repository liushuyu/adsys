# Network shares

The mount managers allow AD administrators to specify network shares that must be mounted in the filesystem when the client logs in.

Currently, the supported protocols are samba and nfs.

## Feature Availability

This feature is available only for subscribers of **Ubuntu Pro**.

## User mounts

The mount process for these mounts is triggered at the moment a user logs in. User mounts are accessible in the file manager and the user has the ability to unmount them manually.

By default, the mount process is made anonymously and it's up to the administrator to ensure the safety and the permissions of the shared location. In cases of authentication needed, a kerberos tag can be added to the shared drive entry (as described on the `Setting up the policy` section).

User mount policies are located under `User Configuration > Policies > Administrative Templates > Ubuntu > Session management > User Drive Mapping`, as shown in the following picture.

![Path to User Drive Mapping policy](images/Network-shares/user-mounts-list.png)

### Setting up the policy

The form is a list of shared drives that should be mounted for the user. They must follow the structure {protocol}://{hostname or ip}/{shared location}. If the mount requires kerberos authentication, the tag [krb5] must be added as a prefix to the listed entry, i.e. [krb5]{protocol}://{hostname or ip}/{shared location}.

All entries must be separated by a line break.

Values that were not formatted accordingly to the rules specified will cause the policy setup to fail.

![List of user mounts example](images/Network-shares/user-mounts-list.png)

The mount process is handled with gvfs and it defines in which directory the shared drive will be mounted into. Usually, it's mounted under `/run/user/%U/gvfs/`.

### Rules precedence

The policy strategy is "append". Therefore, if multiple policies defining mount locations are to be applied to a user, all of the listed entries will be mounted.

### Errored mounts

Adsys will fail to apply the policy and prevent the login if there's a badly formatted entry listed in the policy or if there is some irregularity on the run directory of the client.

After applying the policy, the mounting process is up to the correctness of the specified entries and gvfs. If the mounting of an entry fails, adsys will continue through the other ones listed, mounting the ones that it was able to and logging the ones that could not be mounted.

### Unmounting

The unmounting process is handled by systemd at the end of the session.
